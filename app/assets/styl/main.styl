// Imports
@import url('http://fonts.googleapis.com/css?family=Pacifico|Roboto:300,400,700')

// Web fonts
@font-face
	src: url('/static/font/baba-icons.svg') format('svg')
	font-family: baba-icons
	font-style: normal
	font-weight: normal

// Design settings
$font-logo = Pacifico, sans-serif
$font-main = Roboto, sans-serif
$font-icon = baba-icons
$line-height = 1.7em
$color-foreground = #2e281f
$color-foreground-1 = desaturate(lighten($color-foreground, 30), 10)
$color-foreground-2 = desaturate(lighten($color-foreground, 50), 10)
$color-foreground-3 = lighten($color-foreground, 70)
$site-width = 70em
$header-height = 3.5em
$gutter = 2em
$half-gutter = ($gutter / 2)
$quarter-gutter = ($gutter / 4)

$color-accent = #d32
$color-red = #d32
$color-yellow = #e92
$color-green = #7a3

// CSS reset
global-reset()

// Icons
i.icon
	font: normal 1em/1em $font-icon
	&.icon-add
		&::before
			content: '\e800'
	&.icon-delete
		&::before
			content: '\e801'
	&.icon-edit
		&::before
			content: '\e802'
	&.icon-refresh
		&::before
			content: '\e803'
	&.icon-sort-ascending
		&::before
			content: '\e804'
	&.icon-sort-descending
		&::before
			content: '\e805'
	&.icon-minus
		&::before
			content: '\e806'
	&.icon-plus
		&::before
			content: '\e807'
	&.icon-whitespace
		&::before
			content: '\e808'

// Main elements
p
	margin: $half-gutter 0

strong
	font-weight: 700

a
	color: $color-accent
	transition: all .2s ease
	&:hover
		color: lighten($color-accent, 15)

// Form elements
input
	font: 400 .9em/1.9em $font-main
	height: 1.9em
	box-sizing: border-box
	margin: 0
	padding: 0 $quarter-gutter
	outline: none !important
	display: inline-block
	transition: all .2s
	&.input-text
		border: none
		background: #fff
		box-shadow: inset 0 1px 2px rgba(#000, .3)

.btn
	font: 400 .9em/1.9em $font-main
	height: 1.85em
	border: 0
	box-shadow: inset 0 1px 0 rgba(#fff, .2), inset 0 -1px 0 rgba(#000, .3)
	cursor: pointer
	padding: 0 $quarter-gutter
	position: relative
	background: $color-foreground-1
	color: #fff
	text-shadow: 0 -1px 0 rgba(#000, .7)
	text-align: center
	box-sizing: border-box
	border: 1px solid $color-foreground
	transition: all .1s
	display: inline-block
	&:hover
		background: $color-foreground
	&.active
		background: $color-green
		&:hover
			background: darken($color-green, 10)

// Layout
html, body
	font: 300 100%/$line-height $font-main
	color: $color-foreground
	background: url('/static/img/background.png')

header, #contents, footer
	max-width: $site-width
	margin: 0 auto
	padding: 0 $gutter

header, #contents
	box-shadow: 0 10px 40px rgba($color-foreground, .1)

header
	display: flex
	align-items: center
	background: linear-gradient(top, lighten($color-foreground, 15), $color-foreground)
	color: #fff
	height: $header-height
	text-shadow: 0 2px 2px rgba(#000, .8)
	h1
		flex: 1 1 auto
		font: 1.5em $font-logo
		color: #fff
	.import
		flex: 0 1 auto

#contents
	background: #fff
	padding-top: $gutter
	padding-bottom: $gutter

footer
	text-align: center
	color: $color-foreground-2
	text-shadow: 0 1px #fff
	a
		color: @color
		&:hover
			color: $color-foreground-1

// Section styles
section.step
	background: lighten($color-foreground-3, 12)
	border-left: 3px solid $color-foreground
	position: relative
	padding: 0 $half-gutter $half-gutter $gutter
	margin: 0 0 $half-gutter 0
	text-shadow: 0 1px 0 rgba(#fff, .8)
	$header-height = 60px
	$header-padding = 24px
	.number
		position: absolute
		background: $color-foreground
		font-weight: 700
		font-size: 1.15em
		color: #fff
		width: $header-height - $header-padding
		height: @width
		line-height: @height
		text-align: center
		border-radius: 50%
		top: ($header-padding / 2)
		left: -(@width / 2) - 2px
		text-shadow: none
	.contents
		& > h1
			font-weight: 700
			font-size: 1.1em
			line-height: $header-height

.name-grammar
	.name .by
		margin: 0 $quarter-gutter

// Builder styles
$builder-gutter = 5px
section.grammar
	margin-left: -($half-gutter)
	user-select: none
	background: #fff
	padding: $quarter-gutter 0
	section
		padding: 0 $quarter-gutter 0 $half-gutter
		section
			padding: 0 0 0 $quarter-gutter
		h1
			display: flex
			.toggle
				line-height: 1.5em
				width: $half-gutter
				color: $color-foreground-3
				cursor: pointer
				&:hover
					color: $color-foreground-2
				i::before
					font-size: .8em
			.label
				flex: 1 1 auto
				input
					text-transform: uppercase
					font-weight: 700
					border: 0
					text-align: left
					background: transparent
			.comment
				input
					border: 0
					text-align: right
					background: transparent
					&::-webkit-input-placeholder
						color: rgba(#fff, 0)
			.export
				text-transform: uppercase
				font-size: .9em
				.unexported
					opacity: .3
					.btn
						line-height: 1.5em
						height: @line-height
				.exported
					line-height: 1.9em
					color: $color-green
					cursor: pointer
					&:hover
						color: darken($color-green, 20)
					&::before
						font: normal 1em $font-icon
						content: '\e80a'
						padding: 0 $quarter-gutter 0 0
			&:hover
				.export
					.unexported
						opacity: 1
				input
					&::-webkit-input-placeholder
						color: rgba(#000, .3)
		.node-wrapper
			border-left: 1px solid $color-foreground-3
			padding-left: $quarter-gutter
			margin-left: ($quarter-gutter / 2)

.builder
	cursor: default
	background: url('/static/img/background.png')
	box-shadow: inset 0 1px 2px rgba(#000, .1)
	display: flex
	flex-wrap: wrap
	padding: $builder-gutter 0 0 $builder-gutter
	text-shadow: 0 1px 0 rgba(#fff, .7)
	user-select: none
	ul,
	ol,
	li,
	div
		display: flex
		align-items: center
		flex: 0 1 auto
	& > ul,
	& > ol,
	& > li,
	& > div
		margin: 0 $builder-gutter $builder-gutter 0
	li
		display: flex
		flex: 0 1 auto
	& > li
		.actions
			overflow: hidden
			width: 0
			li
				cursor: pointer
				border-left: 1px solid #ddd
				padding: 0 $quarter-gutter
				height: $line-height
				line-height: $line-height
				font-size: .95em
				&:hover
					background: $color-foreground
					color: #fff
					text-shadow: 0 1px 1px rgba(#000, .5)
		&:hover
			padding-right: 0
			.actions
				width: auto
				.delete:hover
					background: $color-red
	.icon::before
		line-height: @line-height
	.buttons
		flex: 1 1 auto
		position: relative

	// word list style
	&.wordlist
		.expr
			box-shadow: 0 1px 2px rgba(#000, .1)
			background: #fff
			.word
				padding: 0 $quarter-gutter
		.add-textfield
			input
				border: 0
				box-shadow: 0 1px 2px rgba(#000, .1)
				background: rgba(#fff, .4)
				height: $line-height
				&:focus
					background: rgba(#fff, .8)
				&::-webkit-input-placeholder
					color: rgba(#000, .3)
					text-shadow: 0 1px 0 rgba(#fff, 1)

	// sentence style
	&.sentence
		.path
			&:not(.preview)
				box-shadow: 0 1px 2px rgba(#000, .1)
				background: #fff
				.components
					margin: 0 $builder-gutter 0 0
					& > li
						margin: 0 0 0 $builder-gutter
						text-transform: uppercase
						font-size: .7em
						&:first-child
							padding: 0 $builder-gutter
							line-height: 1.6em
						&:nth-child(2)
							font-weight: 700
				.prefix, .postfix
					color: $color-foreground-2
					li
						padding: 0 $builder-gutter
				.prefix
					li
						border-right: 1px solid $color-foreground-3
				.postfix
					li
						border-left: 1px solid $color-foreground-3
			.components
				& > li
					&:first-child
						background: $color-foreground-3
						&.adjective
							background: #dee
						&.noun
							background: #edc
						&.verb
							background: #dec
		li.expr
			&:not(.preview)
				box-shadow: 0 1px 2px rgba(#000, .1)
				background: rgba(#fff, .5)
				font-weight: 400
				.word
					padding: 0 $quarter-gutter
		.actions
			.btn
				margin-left: $builder-gutter

.contextmenu-trigger
	cursor: pointer
	& + ul.contextmenu
		font: 300 .9em/$line-height $font-main
		background: #fff
		border: 1px solid $color-foreground-3
		box-sizing: border-box
		display: none
		position: absolute
		z-index: 100
		width: 10em
		margin-top: 0px
		margin-left: 2px
		&, ul.contextmenu
			box-shadow: 0 2px 5px rgba(#000, .08)
		&.active
			display: block
		& > li:first-child
			// speech bubble arrow
			$arrow-offset = .4em
			$arrow-width = .5em
			position: relative
			&::before,
			&::after
				content: ''
				position: absolute
				width: 0
				height: 0
				border-style: solid
			&::before
				border-width: $arrow-width
				border-color: transparent lighten($color-foreground-2, 10) transparent transparent
				left: -(@border-width * 2)
				top: $arrow-offset
			&::after
				border-width: $arrow-width - .05em
				border-color: transparent #fff transparent transparent
				left: -(@border-width * 2) + .05em
				top: $arrow-offset + .05em
			&:hover
				&::after
					border-color: transparent $color-foreground transparent transparent
		li
			position: relative
			display: block
			color: $color-foreground
			cursor: pointer
			&:hover
				color: #fff
				background: $color-foreground
				& > .label::after,
				& > .item > .label::after
					background: linear-gradient(left,
						rgba($color-foreground, 0),
						rgba($color-foreground, 1) 70%,
						$color-foreground)
			&.remove
				&:hover
					background: $color-red
					& > .label::after,
					& > .item > .label::after
						background: linear-gradient(left,
							rgba($color-red, 0),
							rgba($color-red, 1) 70%,
							$color-red)
		.item
			ul.contextmenu
				position: absolute
				display: none
				flex: none
				width: 8em
				background: #fff
				border: 1px solid $color-foreground-3
				top: -1px
				right: -(@width)
				margin-right: -2px
				&.active
					display: block
			&.has-children
				&::after
					font: normal .5em/3em $font-icon
					content: '\e809'
					position: absolute
					right: $quarter-gutter
					z-index: 20
		.label
			white-space: nowrap
			overflow: hidden
			padding: 0 $quarter-gutter
			display: block
			width: 100%
			text-align: left
			box-sizing: border-box
			text-shadow: none
			&::after
				content: ''
				display: block
				width: 2em
				height: $line-height - .1em
				background: linear-gradient(left, rgba(#fff, 0), rgba(#fff, 1) 70%, #fff)
				position: absolute
				right: 0
				top: 0
			&:hover
				font-weight: 400

		.divider-before, .divider-after + li
			margin: 10px 0 0 0
			&::before
				content: ''
				display: block
				height: 1px
				background: $color-foreground-3
				position: absolute
				left: 3%
				width: 94%
				top: -5px
